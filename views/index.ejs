<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/bootstrap.min.css">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script type="text/javascript" src="/javascripts/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="/javascripts/bootstrap.min.js"></script>
    <script type="text/javascript" src="/javascripts/soundcloud_api.js"></script>
  </head>
  <body>

    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container-fluid">

      <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
        <a id="nav-logo" class="navbar-brand" href="#">stratus</a>
      </div>

      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="col-sm-6">
      <div id="nav-search" class="input-group">
        <input type="text" class="form-control input-sm" placeholder="search music">
          <span class="input-group-btn">
            <button class="btn btn-default btn-sm" type="button">Go!</button>
          </span>
      </div><!-- /input-group -->
      </div><!-- /.col-lg-6 -->

        <ul class="nav navbar-nav navbar-right" id="nav-links">
          <li><a href="#">your music</a></li>
          <!-- This is the line of code I'm changing for the modal link to work 8/19 for Authentication------------------------------>
          <% if(token) { %>
            <li id="logoutButton"><a href="/logout">logout</a></li>
          <% } else { %>
            <li id="loginButton"><a href="#">login</a></li>
          <% } %>
        </ul>
      </div><!-- /.navbar-right close-->

      </div><!-- /.container-fluid close-->
    </nav><!-- /.nav header close-->

    <div class="container">
      <div class="row">
        <div class="col-md-8 col-md-offset-2">
          <form>
            <div class="input-group">
              <input id="input-search" name="search" type="text" class="form-control input-lg" placeholder="Search Music">
              <span class="input-group-btn">
                <button id="btn-search" class="btn btn-primary btn-lg" type="submit"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
              </span>
            </div>
          </form>
          <div id="results">
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -------------------------------------------------------------->
    <div class="modal fade" id="myModal" role="dialog">
      <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Authentication modal, used with: user.ejs and index.ejs<br>
            and will exist in the nav bar and the Favorites star</h4>
          </div>
          <div class="modal-body">
    <!-- text inside modal -------->
            <div class="container1">
    <h2>Please sign in</h2>
    <form role="form" method="post" action="/signin">
    <div class="form-group">
      <label for="email">Email:</label>
      <input name="email" type="email" class="form-control" id="email" placeholder="Enter email">
    </div>
    <div class="form-group">
      <label for="pwd">Password:</label>
      <input name="password" type="password" class="form-control" id="pwd" placeholder="Enter password">
    </div>
    <button type="submit" class="btn btn-default">Submit</button>
    </form>
    </div><br>
    <!-- button for create new account -->
    <button type="button" class="btn btn-primary">Create new account</button>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    </div>
    <script>
    $("#loginButton").click(function(){
      $("#myModal").modal();
    });
    /*$('#logoutButton').click(function(){

    })*/
    </script>
    <!-- End of David's modal code  -------------------->

    <script>
      $(function(){
        var $input = $('#input-search');
        var $searchBtn = $('#btn-search');
        var $results = $('#results')
        $searchBtn.click(function(event){
          event.preventDefault();
          $.ajax({
              url: 'http://localhost:3000/api/search',
              data: {searchString: $input.val()},
              contentType: "application/json; charset=utf-8",
              dataType: 'json',
              success: function(response){
                var results = response;
                $('#results').slideUp("slow", function(){
                  $('.soundcloud-embed').remove();
                  for(var i = 0; i < response.length; i ++) {
                    $results.append($('<iframe id="sc-embed-'+ i + '" class="soundcloud-embed" width="100%" height="120" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/' + results[i] + '&amp;color=18BC9C&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false"></iframe>'));
                  }
                  $('#results').slideDown("slow");
                })
              }
          });
        });
      })
    </script>

    <nav class="navbar navbar-default navbar-fixed-bottom">
      <div id="footer-text" class="container">
          <p>copyright &#169 2015 stratus and soundcloud</p>
      </div>
    </nav><!-- /.nav footer close-->

  </body>
</html>
